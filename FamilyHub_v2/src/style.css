/* * =========================================
 * 1. FUNDAMENTALE TAILWIND-IMPORTE
 * Diese MÜSSEN an erster Stelle stehen.
 * =========================================
 */
/*
 * The following @tailwind directives require Tailwind CSS to be processed via PostCSS or a compatible build tool.
 * If you see "Unknown at rule @tailwind", ensure your build process includes Tailwind CSS.
 */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* * =========================================
 * 2. BASIS-DESIGN-SYSTEM (ROOT)
 * =========================================
 */
:root, html {
    --primary-bg: 10 9 8;
    --text-main: 242 244 243;
    --text-secondary: 156 163 175;
    --text-tertiary: 107 114 128;
    --accent-glow: 160 70 104;
    --glass-bg: 10 9 8;
    --border-glass: 242 244 243;
    --shadow-glow: 0 0 15px rgba(160, 70, 104, 0.4);
    --shadow-glow-hover: 0 0 25px rgba(160, 70, 104, 0.6);
    --radius-container: 16px;
    --radius-btn: 10px;
    --transition-main: 0.3s ease-in-out;
}

/* * =========================================
 * 3. TAILWIND LAYER-ANPASSUNGEN
 * =========================================
 */
@layer base {
    body {
        background-color: var(--primary-bg);
        color: var(--text-main);
        min-height: 100vh;
    }
}

@layer utilities {
    .text-gradient {
        background: linear-gradient(90deg, var(--accent-glow), var(--text-main));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        color: transparent;
    }
    .text-secondary {
        color: var(--text-secondary);
    }
    
    /* --- Seiten-Übergangs-Animationen --- */
    .page-fade-out {
        animation: fadeOut 0.2s ease-out forwards;
    }
    .page-fade-in {
        animation: fadeIn 0.3s ease-in forwards;
    }

    @keyframes fadeOut {
        from { opacity: 1; transform: translateY(0); }
        to { opacity: 0; transform: translateY(10px); }
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .bg-accent-glow\/20 {
        background-color: rgba(160, 70, 104, 0.2);
    }
    .bg-accent-glow\/30 {
        background-color: rgba(160, 70, 104, 0.3);
    }
}

@layer components {

    /* --- A. Hauptkomponenten --- */
    .glass-premium {
        @apply bg-glass-bg border border-border-glass backdrop-blur-lg;
        box-shadow: var(--shadow-card);
    }

    .post-card {
        @apply glass-premium p-4 sm:p-6 mb-6; /* Bündelt existierende Stile */
        @apply transition-all duration-200 ease-in-out;
    }

    .post-card:hover {
        @apply scale-[1.01];
        box-shadow: var(--shadow-glow-hover);
    }
    
    .cta-primary-glow {
        background: var(--accent-glow);
        color: var(--text-main);
        border-radius: var(--radius-btn);
        box-shadow: var(--shadow-glow);
        padding: 12px 20px;
        font-weight: 600;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        outline: none;
        border: none;
        cursor: pointer;
        display: inline-flex; 
        align-items: center;
        justify-content: center;
    }
    .cta-primary-glow:hover, .cta-primary-glow:focus {
        transform: scale(1.03); 
        box-shadow: var(--shadow-glow-hover); 
    }

    /* --- NEU: Formular-Komponenten --- */
    .form-input {
        @apply w-full bg-white/5 border border-border-glass rounded-lg px-4 py-2;
        @apply text-text-main placeholder-text-tertiary;
        @apply transition-all duration-200;
    }
    .form-input:focus {
        @apply bg-white/10 border-accent-glow/50 ring-2 ring-accent-glow/30 outline-none;
    }

    /* --- B. Layout-Komponenten --- */
    .page-container {
        width: 100%;
        max-width: 42rem; /* max-w-2xl */
        margin-left: auto;
        margin-right: auto;
        padding-left: 1rem; /* px-4 */
        padding-right: 1rem;
    }
    @media (min-width: 1024px) {
        .page-container {
            max-width: 56rem; /* max-w-4xl */
        }
    }

    .icon-button-ghost {
        padding: 0.5rem;
        border-radius: 9999px;
        color: var(--text-secondary);
        transition-property: color, background-color;
        transition-duration: 200ms;
    }
    .icon-button-ghost:hover {
        background-color: rgba(255,255,255,0.10);
        color: #fff;
    }
    
    /* --- C. Mobile Nav-Komponenten --- */
    #bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 50;
        background-color: var(--glass-bg);
        backdrop-filter: blur(10px);
        border-top: 1px solid var(--border-glass);
        padding-top: 8px;
        padding-bottom: max(8px, env(safe-area-inset-bottom));
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.25rem;
        color: var(--text-secondary);
        transition-property: all;
        transition-duration: 200ms;
        flex-basis: 0; 
        flex-grow: 1;
        padding: 4px 0;
    }
    .nav-item i { width: 1.5rem; height: 1.5rem; }
    .nav-item span { font-size: 0.75rem; line-height: 1rem; }
    .nav-item.active {
        color: var(--accent-glow);
        filter: drop-shadow(0 0 8px var(--accent-glow));
    }
    .nav-item.active i { transform: scale(1.10); }

    .fab-create-post {
        /* Erbt vom Basis-Button (cta-primary-glow) */
        background: var(--accent-glow);
        color: var(--text-main);
        border-radius: var(--radius-btn);
        box-shadow: var(--shadow-glow);
        padding: 12px 20px;
        font-weight: 600;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        outline: none;
        border: none;
        cursor: pointer;
        display: inline-flex; 
        align-items: center;
        justify-content: center;

        position: fixed;
        bottom: 6rem;
        right: 1rem;
        width: 60px;
        height: 60px;
        border-radius: 99px;
        padding: 0;
        z-index: 40;
    }
    @media (min-width: 1024px) {
        .fab-create-post {
            bottom: 2.5rem;
            right: 2.5rem;
        }
    }

    /* --- D. Feed-Karten-Komponenten --- */
    .action-button {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        transition-property: color, background-color;
        transition-duration: 200ms;
    }
    .action-button:hover { color: #fff; }
    .action-button i { transition: all 0.2s ease; }
    .action-button:hover i { transform: scale(1.10); }
    .action-button.active {
        color: var(--accent-glow);
        fill: var(--accent-glow);
    }

    /* --- E. Desktop-Dashboard (Unverändert) --- */
    .nav-item-desktop {
        @apply flex items-center gap-3 p-3 rounded-lg text-secondary font-medium;
        @apply transition-all duration-200;
    }
    .nav-item-desktop:hover {
        @apply bg-white/10 text-white;
    }
    .nav-item-desktop.active {
        @apply bg-accent-glow/20 text-accent-glow;
    }
    .nav-badge-premium {
        @apply ml-auto bg-accent-glow text-white text-xs font-bold px-2 py-0.5 rounded-full;
        box-shadow: var(--shadow-glow);
    }

    /* * =========================================
     * 4. NEUE MODUL-STILE (POLL & GRATITUDE)
     * =========================================
     */

    /* --- F. Poll-Komponenten (Umfragen) --- */
    .poll-option {
        @apply w-full p-3 mb-2 rounded-lg border-2 border-border-glass bg-white/5 cursor-pointer transition-all duration-200;
        position: relative;
    }
    .poll-option:hover {
        @apply border-rose-500 bg-rose-500/10;
    }
    .poll-option.voted-by-user {
        @apply border-accent-glow bg-accent-glow/20 ring-2 ring-accent-glow;
    }
    .poll-result-bar {
        @apply absolute top-0 left-0 h-full rounded-md bg-accent-glow/30 transition-all duration-500;
        z-index: -1;
    }

    /* --- G. Gratitude-Komponenten (Dankbarkeit) --- */
    .gratitude-card-content {
        @apply flex flex-col sm:flex-row items-center text-center sm:text-left gap-4 p-4;
    }
    .gratitude-arrow {
        @apply text-primary-rose text-3xl transform rotate-90 sm:rotate-0;
    }
    .gratitude-avatar {
        @apply w-16 h-16 rounded-full object-cover border-2 border-border-glass;
    }
    /* --- H. Goals-Widget --- */
    .goal-widget-card {
        @apply glass-premium p-4 rounded-xl mb-6;
    }
    .goal-item {
        @apply mb-3;
    }
    .goal-progress-bar-bg {
        @apply w-full h-2 bg-white/10 rounded-full overflow-hidden;
    }
    .goal-progress-bar-fg {
        @apply h-full bg-primary-rose rounded-full transition-all duration-500;
        box-shadow: var(--shadow-glow);
    }
      /* --- I. Expense-Widget --- */
      .expense-card {
          @apply glass-premium p-4 rounded-xl border-l-4 border-primary-rose;
      }
      .expense-private-badge {
          @apply flex items-center gap-1 text-xs text-secondary bg-white/5 px-2 py-0.5 rounded-full;
      }
      .expense-avatar-stack {
          @apply flex -space-x-2 overflow-hidden;
      }
      .expense-avatar {
          @apply inline-block h-6 w-6 rounded-full ring-2 ring-primary-bg;
      }

    /* --- J. Chat-Komponenten --- */
      .chat-list-item {
          @apply flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all duration-200;
      }
      .chat-list-item:hover, .chat-list-item.active {
          @apply bg-white/10;
      }
      .chat-list-avatar {
          @apply w-12 h-12 rounded-full object-cover;
      }
      .chat-list-unread-badge {
          @apply w-3 h-3 bg-primary-rose rounded-full ml-auto;
          box-shadow: var(--shadow-glow);
      }

      /* Nachrichten-Sprechblasen */
      .chat-bubble {
          @apply p-3 rounded-xl max-w-xs md:max-w-md;
          width: fit-content;
      }
      .chat-bubble-other {
          @apply bg-white/10 rounded-bl-lg; /* Andere */
          align-self: flex-start;
      }
      .chat-bubble-own {
          @apply bg-primary-rose/80 text-white rounded-br-lg; /* Eigene */
          align-self: flex-end;
      }
      .chat-message-container {
          @apply flex flex-col;
      }
      .chat-message-sender {
          @apply text-xs text-secondary mb-1;
      }

    /* --- K. Chat-Erstellungs-Modal --- */
      .member-select-item {
          @apply flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all duration-200 border border-border-glass;
      }
      .member-select-item:hover {
          @apply bg-white/10;
      }
      .member-select-item.selected {
          @apply bg-primary-rose/20 border-primary-rose ring-2 ring-primary-rose;
      }
      .member-select-avatar {
          @apply w-10 h-10 rounded-full object-cover;
      }

    /* --- L. Pinnwand-Komponenten --- */
    .pinnwand-column {
        @apply w-full md:w-80 lg:w-96 flex-shrink-0;
    }
    .pinnwand-cards {
        @apply space-y-3 min-h-[100px] p-1 rounded-lg;
        /* Stil für Drag-Over */
        @apply transition-colors duration-200;
    }
    .pinnwand-cards.drag-over {
        @apply bg-white/10;
    }
    .pinnwand-card {
        @apply glass-premium p-4 rounded-lg cursor-grab;
        /* NEU: Flexbox für Button */
        @apply flex justify-between items-center gap-2;
        transition: all 0.2s ease;
    }
    .pinnwand-card:active {
        @apply cursor-grabbing scale-105 bg-primary-bg;
    }
    .pinnwand-card.dragging {
        @apply opacity-50 scale-95;
    }
    .pinnwand-card.invisible {
        @apply opacity-0;
    }

    /* --- N. Challenges & Leaderboard --- */
        .leaderboard-item {
            @apply glass-premium p-3 rounded-lg flex items-center gap-4;
        }
        .leaderboard-rank {
            @apply text-lg font-bold text-primary-rose w-6 text-center;
        }
        .leaderboard-avatar {
            @apply w-10 h-10 rounded-full object-cover;
        }
        .leaderboard-points {
            @apply ml-auto text-lg font-semibold text-white;
        }
        .leaderboard-points i {
            @apply w-4 h-4 text-primary-rose inline-block -mt-1;
            fill: var(--accent-glow);
        }

        /* Challenge-Karten */
        .challenge-card {
            @apply glass-premium p-4 rounded-xl flex items-center gap-4;
        }
        .challenge-icon {
            @apply w-12 h-12 rounded-lg flex-shrink-0 bg-primary-rose/20 text-primary-rose flex items-center justify-center;
        }
        .challenge-progress-bar-bg {
            @apply w-full h-2 bg-white/10 rounded-full overflow-hidden mt-1;
        }
        .challenge-progress-bar-fg {
            @apply h-full bg-primary-rose rounded-full transition-all duration-500;
            box-shadow: var(--shadow-glow);
        }
        
    /* --- K. Modal-System --- */
    .modal {
        @apply fixed inset-0 z-[99] flex items-center justify-center p-4;
        
        /* Der "Sophisticated Glow"-Hintergrund-Overlay */
        background-color: rgba(10, 9, 8, 0.5); /* --primary-bg mit 50% Transparenz */
        @apply backdrop-blur-md;
        
        @apply opacity-0 transition-opacity duration-300 ease-in-out;
    }

    .modal-open {
        @apply opacity-100;
    }

    /* * Sorgt für das "Hineinzoomen" der Karte (der .glass-premium-Container)
     * wenn das Modal geöffnet wird.
     */
    .modal .glass-premium {
        @apply transition-transform duration-300 ease-in-out scale-95;
    }
    .modal-open .glass-premium {
        @apply scale-100;
    }
    
    /* --- M. Einstellungs-Layout --- */
    .settings-layout {
        @apply grid grid-cols-1 lg:grid-cols-[240px_1fr] gap-6;
    }
    .settings-nav {
        @apply flex flex-row lg:flex-col gap-2 overflow-x-auto lg:overflow-x-visible pb-2 lg:pb-0;
    }
    .settings-nav-item {
        @apply flex items-center gap-3 p-3 rounded-lg text-secondary font-medium whitespace-nowrap;
        @apply transition-all duration-200;
    }
    .settings-nav-item:hover {
        @apply bg-white/10 text-white;
    }
    .settings-nav-item.active {
        @apply bg-accent-glow/20 text-accent-glow;
        font-weight: 600;
    }
    .settings-nav-item:disabled {
        @apply opacity-40 cursor-not-allowed;
    }
    .settings-nav-item i {
        @apply w-5 h-5 flex-shrink-0;
    }

    /* --- N. Galerie-Post-Komponente --- */
    .gallery-post-grid {
        @apply grid gap-2 rounded-lg overflow-hidden border border-border-glass;
    }
    /* Dynamisches Grid basierend auf der Anzahl der Bilder (max 4) */
    .gallery-post-grid.count-1 { @apply grid-cols-1; }
    .gallery-post-grid.count-2 { @apply grid-cols-2; }
    .gallery-post-grid.count-3 { @apply grid-cols-3; }
    .gallery-post-grid.count-4 { @apply grid-cols-2; } /* 2x2 Grid bei 4 Bildern */

    .gallery-post-item {
        @apply aspect-square bg-white/5;
    }
    .gallery-post-item img {
        @apply w-full h-full object-cover;
    }
    
    /* --- O. Kalender-Dashboard --- */
    .btn-filter {
        @apply px-4 py-2 rounded-full text-sm font-semibold border;
        @apply transition-all duration-200;
    }
    .btn-filter:hover {
        @apply text-white bg-white/10;
    }
    .btn-filter.active {
        @apply text-accent-glow bg-accent-glow/20;
    }
    
    /* Stellt sicher, dass das Monats-Grid flexibel ist */
    #calendar-body {
        @apply flex flex-col flex-1;
    }
    .calendar-row {
        @apply grid grid-cols-7 gap-1 flex-1;
    }
    .calendar-cell {
        @apply bg-white/5 border border-transparent rounded-lg p-2;
        @apply transition-colors duration-200 cursor-pointer;
        min-height: 80px; /* Mindesthöhe für Desktop */
    }
    .calendar-cell:hover {
        @apply bg-white/10 border-border-glass;
    }
    .calendar-cell.empty {
        @apply bg-transparent pointer-events-none;
    }
    .calendar-cell.today {
        @apply bg-accent-glow/20;
    }
    .calendar-date-label {
        @apply text-xs font-bold text-secondary;
    }
    .calendar-date-label.today {
        @apply text-accent-glow;
    }
    .calendar-events {
        @apply mt-1 space-y-1;
    }
    .event-bar {
        @apply text-xs bg-accent-glow/50 text-white p-1 rounded truncate;
    }
    
    /* Agenda-Ansicht */
    .agenda-item {
        @apply flex items-center gap-4 p-3 bg-white/5 rounded-lg;
    }
    .agenda-date-box {
        @apply flex flex-col items-center justify-center w-12 h-12 rounded-lg bg-accent-glow/20 text-accent-glow flex-shrink-0;
    }
    .agenda-date-box .month {
        @apply text-xs font-bold uppercase;
    }
    .agenda-date-box .day {
        @apply text-xl font-bold -mt-1;
    }
    .agenda-info .title {
        @apply font-semibold text-white;
    }
     .agenda-info .time {
        @apply text-sm text-secondary;
    }

    /* --- P. App-Dashboard (Menü) --- */
    .app-dashboard-grid {
        @apply grid grid-cols-2 lg:grid-cols-4 gap-4;
    }
    .app-dashboard-item {
        @apply glass-premium p-4 rounded-xl text-left;
        @apply transition-all duration-200;
    }
    .app-dashboard-item:hover {
        @apply scale-105 border-accent-glow/50;
    }
    .app-dashboard-item:disabled {
        @apply opacity-40 cursor-not-allowed scale-100 border-border-glass;
    }
    .app-dashboard-icon {
        @apply w-12 h-12 rounded-lg flex items-center justify-center mb-3;
    }
    .app-dashboard-icon i {
        @apply w-6 h-6;
    }
    .app-dashboard-label {
        @apply text-lg font-semibold text-white;
    }

    /* --- Q. Chronik-Modul --- */
    .chronik-day-group {
        @apply mb-6;
    }
    .chronik-day-title {
        @apply text-lg font-semibold text-white mb-3 pb-2 border-b border-border-glass;
    }
    .chronik-item {
        @apply flex items-center gap-3 p-3 rounded-lg;
        @apply transition-all duration-200 cursor-pointer;
    }
    .chronik-item:hover {
        @apply bg-white/10;
    }
    .chronik-icon {
        @apply w-10 h-10 rounded-full flex-shrink-0 flex items-center justify-center bg-white/10 text-secondary;
    }
    .chronik-icon i {
        @apply w-5 h-5;
    }
    .chronik-info .title {
        @apply font-medium text-white;
    }
    .chronik-info .time {
        @apply text-xs text-secondary;
    }
    
    /* --- R. Toggle-Schalter (NEU) --- */
    .toggle-wrapper {
        @apply flex items-center justify-between gap-4 p-4 rounded-lg bg-white/5;
    }
    .toggle-switch {
        @apply relative inline-block w-11 h-6 flex-shrink-0;
    }
    .toggle-switch input {
        @apply opacity-0 w-0 h-0;
    }
    .slider {
        @apply absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-white/20;
        transition: .4s;
        border-radius: 34px;
    }
    .slider:before {
        @apply absolute h-4 w-4 bg-white;
        content: "";
        left: 4px;
        bottom: 4px;
        transition: .4s;
        border-radius: 50%;
    }
    input:checked + .slider {
        background-color: var(--accent-glow);
        box-shadow: var(--shadow-glow);
    }
    input:checked + .slider:before {
        transform: translateX(20px);
    }
}